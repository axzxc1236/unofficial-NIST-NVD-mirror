{
  "cveId": "CVE-2021-47085",
  "eventName": "CVE Translated",
  "cveChangeId": "490CACA7-2FD6-4A39-98E6-2122BFBEE4F3",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "created": "2024-03-19T14:15:07.603",
  "details": [
    {
      "action": "Removed",
      "type": "Translation",
      "oldValue": "Title: kernel de Linux\nDescription: En el kernel de Linux se ha resuelto la siguiente vulnerabilidad: hamradio: mejora la solución incompleta para evitar NPD. El commit anterior 3e0588c291d6 (\"hamradio: defer ax25 kfree after unregister_netdev\") reordena las operaciones kfree y unregister_netdev para prevenir UAF. Esta confirmación mejora la anterior al diferir también la anulación del puntero ax-&gt;tty. De lo contrario, se produce un error de desreferencia del puntero NULL. A continuación se muestra parte del seguimiento de la pila. ERROR: desreferencia del puntero NULL del kernel, dirección: 0000000000000538 RIP: 0010:ax_xmit+0x1f9/0x400... Seguimiento de llamadas: dev_hard_start_xmit+0xec/0x320 sch_direct_xmit+0xea/0x240 __qdisc_run+0x166/0x5c0 __dev_queue_x mit+0x2c7/0xaf0 ax25_std_establecer_data_link+0x59/0x60 ax25_connect+0x3a0/0x500? seguridad_socket_connect+0x2b/0x40 __sys_connect+0x96/0xc0 ? __hrtimer_init+0xc0/0xc0? common_nsleep+0x2e/0x50? switch_fpu_return+0x139/0x1a0 __x64_sys_connect+0x11/0x20 do_syscall_64+0x33/0x40 Entry_SYSCALL_64_after_hwframe+0x44/0xa9 El punto de bloqueo se muestra a continuación static void ax_encaps(...) { ... set_bit(TTY_DO_WRITE_WAKEUP, &amp;ax-&gt; tty-&gt;banderas ); // hacha-&gt;tty = NULL! ... } Al colocar la acción de anulación después de unregister_netdev, el puntero ax-&gt;tty no se asignará ya que la capa de marco NULL net_device está bien sincronizada."
    }
  ]
}