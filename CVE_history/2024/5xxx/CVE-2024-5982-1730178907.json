{
  "cveId": "CVE-2024-5982",
  "eventName": "New CVE Received",
  "cveChangeId": "2F04A1C5-5645-4CA0-82AB-FE8CC71FD007",
  "sourceIdentifier": "security@huntr.dev",
  "created": "2024-10-29T13:15:07.637",
  "details": [
    {
      "action": "Added",
      "type": "Description",
      "newValue": "A path traversal vulnerability exists in the latest version of gaizhenbiao/chuanhuchatgpt. The vulnerability arises from unsanitized input handling in multiple features, including user upload, directory creation, and template loading. Specifically, the load_chat_history function in modules/models/base_model.py allows arbitrary file uploads, potentially leading to remote code execution (RCE). The get_history_names function in utils.py permits arbitrary directory creation. Additionally, the load_template function in utils.py can be exploited to leak the first column of CSV files. These issues stem from improper sanitization of user inputs concatenated with directory paths using os.path.join."
    },
    {
      "action": "Added",
      "type": "Reference",
      "newValue": "huntr.dev https://huntr.com/bounties/5d5c5356-e893-44d1-b5ca-642aa05d96bb [No types assigned]"
    },
    {
      "action": "Added",
      "type": "Reference",
      "newValue": "huntr.dev https://github.com/gaizhenbiao/chuanhuchatgpt/commit/952fc8c3cbacead858311747cddd4bedcb4721d7 [No types assigned]"
    },
    {
      "action": "Added",
      "type": "CWE",
      "newValue": "huntr.dev CWE-22"
    },
    {
      "action": "Added",
      "type": "CVSS V3",
      "newValue": "huntr.dev AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H"
    }
  ]
}